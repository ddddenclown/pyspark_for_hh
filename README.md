У меня было три набора данных: список продуктов, список категорий и таблица, где указано, какие продукты к каким категориям относятся. Задача это показать все пары "продукт — категория", аа ещё не забыть про те продукты, у которых категории нет вообще.

Я просто объединил сначала продукты с отношениями, а потом добавил к ним категории. Специально использовал left join, чтобы не потерять те товары, у которых категория пока не назначена — они в итоге просто будут с пустым значением в колонке категории.

Для удобства не стал заморачиваться с файлами и данные ввёл прямо в коде, чтобы быстрее всё проверить и показать, как работает
